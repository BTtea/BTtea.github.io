I2RlZmluZSBfWE9QRU5fU09VUkNFIDcwMAojZGVmaW5lIF9HTlVfU09VUkNFCiNpbmNsdWRlIDxk
aXJlbnQuaD4KI2luY2x1ZGUgPGVycm5vLmg+CiNpbmNsdWRlIDxmY250bC5oPgojaW5jbHVkZSA8
c3RkaW8uaD4KI2luY2x1ZGUgPHN0cmluZy5oPgojaW5jbHVkZSA8dW5pc3RkLmg+CiNpbmNsdWRl
IDxzdGRsaWIuaD4KI2luY2x1ZGUgPGZ0dy5oPgoKI2luY2x1ZGUgPHN5cy93YWl0Lmg+CiNpbmNs
dWRlIDxzeXMvc3RhdC5oPgojaW5jbHVkZSA8c3lzL3R5cGVzLmg+CiNpbmNsdWRlIDxzeXMvc2ln
bmFsLmg+CgovLyA2NC1iaXQgbGlicmFyeQojaWZkZWYgX19hbWQ2NF9fCmNvbnN0IGNoYXIgc2Vy
dmljZV9pbnRlcnBbXSBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuaW50ZXJwIikpKSA9ICIvbGli
NjQvbGQtbGludXgteDg2LTY0LnNvLjIiOwojZW5kaWYKLy8gMzItYml0IGxpYnJhcnkKI2lmZGVm
IF9faTM4Nl9fCmNvbnN0IGNoYXIgc2VydmljZV9pbnRlcnBbXSBfX2F0dHJpYnV0ZV9fKChzZWN0
aW9uKCIuaW50ZXJwIikpKSA9ICIvbGliL2xkLWxpbnV4LnNvLjIiOwojZW5kaWYKCmludCB1bmxp
bmtfY2IoY29uc3QgY2hhciAqZnBhdGgsIGNvbnN0IHN0cnVjdCBzdGF0ICpzYiwgaW50IHR5cGVm
bGFnLCBzdHJ1Y3QgRlRXICpmdHdidWYpCnsKICAgIGludCBydiA9IHJlbW92ZShmcGF0aCk7Cgog
ICAgaWYgKHJ2KQogICAgICAgIHBlcnJvcihmcGF0aCk7CgogICAgcmV0dXJuIHJ2Owp9CgppbnQg
cm1yZihjaGFyICpwYXRoKQp7CiAgICByZXR1cm4gbmZ0dyhwYXRoLCB1bmxpbmtfY2IsIDY0LCBG
VFdfREVQVEggfCBGVFdfUEhZUyk7Cn0KCnZvaWQgZW50cnkoKQp7CiAgICBpbnQgcmVzOwogICAg
RklMRSAqZnA7CiAgICBjaGFyIGJ1ZltQQVRIX01BWF07CiAgICBpbnQgcGlwZWZkWzJdOwogICAg
Y2hhciAqY21kOwogICAgaW50IGFyZ2M7CiAgICBjaGFyICoqYXJndjsKICAgIHJlZ2lzdGVyIHVu
c2lnbmVkIGxvbmcgKnJicCBhc20gKCJyYnAiKTsKCiAgICBhcmdjID0gKihpbnQgKikocmJwKzEp
OwogICAgYXJndiA9IChjaGFyICoqKXJicCsyOwoKICAgIHJlcyA9IG1rZGlyKCJHQ09OVl9QQVRI
PS4iLCAwNzc3KTsKICAgIGlmIChyZXMgPT0gLTEgJiYgZXJybm8gIT0gRUVYSVNUKQogICAgewog
ICAgICAgIHBlcnJvcigiRmFpbGVkIHRvIGNyZWF0ZSBkaXJlY3RvcnkiKTsKICAgICAgICBfZXhp
dCgxKTsKICAgIH0KCiAgICByZXMgPSBjcmVhdCgiR0NPTlZfUEFUSD0uLy5wa2V4ZWMiLCAwNzc3
KTsKCiAgICByZXMgPSBta2RpcigiLnBrZXhlYyIsIDA3NzcpOwoKICAgIGZwID0gZm9wZW4oIi5w
a2V4ZWMvZ2NvbnYtbW9kdWxlcyIsICJ3KyIpOwogICAgaWYgKGZwID09IE5VTEwpCiAgICB7CiAg
ICAgICAgcGVycm9yKCJGYWlsZWQgdG8gb3BlbiBvdXRwdXQgZmlsZSIpOwogICAgICAgIF9leGl0
KDEpOwogICAgfQogICAgaWYgKGZwdXRzKCJtb2R1bGUgVVRGLTgvLyBQS0VYRUMvLyBwa2V4ZWMg
MiIsIGZwKSA8IDApCiAgICB7CiAgICAgICAgcGVycm9yKCJGYWlsZWQgdG8gd3JpdGUgY29uZmln
Iik7CiAgICAgICAgX2V4aXQoMSk7CiAgICB9CiAgICBmY2xvc2UoZnApOwoKICAgIGJ1ZltyZWFk
bGluaygiL3Byb2Mvc2VsZi9leGUiLCBidWYsIHNpemVvZihidWYpKV0gPSAwOwogICAgcmVzID0g
c3ltbGluayhidWYsICIucGtleGVjL3BrZXhlYy5zbyIpOwogICAgaWYgKHJlcyA9PSAtMSkKICAg
IHsKICAgICAgICBwZXJyb3IoIkZhaWxlZCB0byBjb3B5IGZpbGUiKTsKICAgICAgICBfZXhpdCgx
KTsKICAgIH0KICAgIAogICAgcGlwZShwaXBlZmQpOwogICAgaWYgKGZvcmsoKSA9PSAwKQogICAg
ewogICAgICAgIGNsb3NlKHBpcGVmZFsxXSk7CgogICAgICAgIGJ1ZltyZWFkKHBpcGVmZFswXSwg
YnVmLCBzaXplb2YoYnVmKS0xKV0gPSAwOwogICAgICAgIGlmIChzdHJzdHIoYnVmLCAicGtleGVj
IC0tdmVyc2lvbiIpID09IGJ1ZikgewogICAgICAgICAgICAvLyBDbGVhbnVwIGZvciBzaXR1YXRp
b25zIHdoZXJlIHRoZSBleHBsb2l0IGRpZG4ndCB3b3JrCiAgICAgICAgICAgIHB1dHMoIkV4cGxv
aXQgZmFpbGVkLiBUYXJnZXQgaXMgbW9zdCBsaWtlbHkgcGF0Y2hlZC4iKTsKCiAgICAgICAgICAg
IHJtcmYoIkdDT05WX1BBVEg9LiIpOwogICAgICAgICAgICBybXJmKCIucGtleGVjIik7CiAgICAg
ICAgfQoKICAgICAgICBfZXhpdCgwKTsKICAgIH0KCiAgICBjbG9zZShwaXBlZmRbMF0pOwoKICAg
IGR1cDIocGlwZWZkWzFdLCAyKTsKICAgIGNsb3NlKHBpcGVmZFsxXSk7CgogICAgY21kID0gTlVM
TDsKICAgIGlmIChhcmdjID4gMSkgewogICAgICAgIGNtZCA9IG1lbWNweShhcmd2WzFdLTQsICJD
TUQ9IiwgNCk7CiAgICB9CiAgICBjaGFyICphcmdzW10gPSB7TlVMTH07CiAgICBjaGFyICplbnZb
XSA9IHsiLnBrZXhlYyIsICJQQVRIPUdDT05WX1BBVEg9LiIsICJDSEFSU0VUPXBrZXhlYyIsICJT
SEVMTD1wa2V4ZWMiLCBjbWQsIE5VTEx9OwogICAgZXhlY3ZlKCIvdXNyL2Jpbi9wa2V4ZWMiLCBh
cmdzLCBlbnYpOwoKICAgIC8vIEluIGNhc2UgcGtleGVjIGlzIG5vdCBpbiAvdXNyL2Jpbi8KICAg
IGV4ZWN2cGUoInBrZXhlYyIsIGFyZ3MsIGVudik7CgogICAgX2V4aXQoMCk7CiAgICAKfQoKdm9p
ZCBnY29udigpIHt9CnZvaWQgZ2NvbnZfaW5pdCgpCnsKICAgIGNsb3NlKDIpOwogICAgZHVwMigx
LCAyKTsKCiAgICBjaGFyICpjbWQgPSBnZXRlbnYoIkNNRCIpOwoKICAgIHNldHJlc3VpZCgwLCAw
LCAwKTsKICAgIHNldHJlc2dpZCgwLCAwLCAwKTsKICAgIHJtcmYoIkdDT05WX1BBVEg9LiIpOwog
ICAgcm1yZigiLnBrZXhlYyIpOwoKICAgIGlmIChjbWQpIHsKICAgICAgICBleGVjdmUoIi9iaW4v
c2giLCAoY2hhciAqW10peyIvYmluL3NoIiwgIi1jIiwgY21kLCBOVUxMfSwgTlVMTCk7CiAgICB9
IGVsc2UgewogICAgICAgIC8vIFRyeSBpbnRlcmFjdGl2ZSBiYXNoIGZpcnN0CiAgICAgICAgZXhl
Y3ZlKCIvYmluL2Jhc2giLCAoY2hhciAqW10peyItaSIsIE5VTEx9LCBOVUxMKTsKCiAgICAgICAg
Ly8gSW4gY2FzZSBpbnRlcmFjdGl2ZSBiYXNoIHdhcyBub3QgcG9zc2libGUKICAgICAgICBleGVj
dmUoIi9iaW4vc2giLCAoY2hhciAqW10peyIvYmluL3NoIiwgTlVMTH0sIE5VTEwpOwogICAgfQog
ICAgX2V4aXQoMCk7Cn0K
